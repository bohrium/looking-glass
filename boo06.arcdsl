(split<int><gridpair> (many noise) \x1:int ->
(split<int><gridpair> x1 \x2:int ->
(split<grid><gridpair> (split<shape><grid> (gen_shape noise x2) \x4:shape ->
(paint_sprite
   (reserve_shape
      noise
      (monochrome x4 red)
      x4
      (center x4))
   (monochrome x4 blue)
   (center x4))) \x3:grid ->
(pair<gridpair>
   (reflect_grid x3 northeast)
   x3))))